[TOC]

# REST API

URL 结构 http://192.168.3.250:5001/method


### 通用返回结果
```python
# 正常返回结果
{
    "ret_code" : 0          # 返回码，0为ok
    "task" : "pos/ner/ner_rel"      # 输入的任务
}
```

```python
# 异常返回结果
{
    "ret_code" : -1          # 返回码，非0表示错误
    "task" : "pos/ner/ner_rel"      # 输入的任务
    "err_info" : "..."      # 具体错误信息
}
```

## 数据格式

本系统主要用于处理序列标注问题，训练模型时需要提供序列数据和对应的标签，预测时提供纯文本。目前在中文/英文命名实体上取得较好的效果。

- NER-format

```python
# 每一行都是一个token,一句话之间用一个空行隔开。
# 第一列对应token(中文单个字，英文单个词(最小单词))		**必须有**
# 第二列是token对应的tag，如PER-LOC-ORG三种	**必须有**

朱 B-person
红 I-person
专 I-person
拟 O
转 O
让 O
红 B-org
宇 I-org
新 I-org
材 I-org
流 O
通 O
股 O
```

- raw data + entity (该功能还未实现)

  如果用户只能提供原始文件，需要按照**一行一句话**的格式提供，同时提供实体字典。示例如下：

```python
## raw data
藏书本来就是所有传统收藏门类中的第一大户，只是我们结束温饱的时间太短而已。
以家乡的历史文献、特定历史时期书刊、某一名家或名著的多种出版物为专题，注意精品、非卖品、纪念品，集成系列，那收藏的过程就已经够您玩味无穷了。
精品、专题、系列、稀见程度才是质量的核心。
...
```

```python
## entity dict
车泽武 PER
英国 LOC
刘杰 PER
青岛电冰箱总厂 ORG
爱知县丰田市 LOC
杰杰 PER
广州美晨股份有限公司 ORG
袁微 PER
西单商场 LOC
```

## 模型训练

### NER模型训练 
- **描述**：选择训练方法，训练NER模型

- **URL**：`/ner_train` 

- **示例**：

  ```python
  {
    "model" : "crf/mlp"   # 选择条件随机场（crf） 或神经网络方式（mlp）训练模型
  }
  ```
  ​
 
## 序列标注

### 词性标注

- **描述**：使用**jieba**提供的分词器，对序列中的每个token的词性进行标注。

- **URL**：`/pos` 

- **示例**：

  ```python
  # user输入list of sentence
    {
        "data" : [ "阳光很好,新的一年即将到来。",
                  "美国无人驾驶汽车已获得道路测试许可证",
                  "苹果发布新品"]
    }

- **返回结果**：
  ```python
  {
    "result": [
        {
            "id": 0,
            "tagger": [
                "nr",
                "nr",
                "d",
                "a",
                "x",
                "a",
                "uj",
                "m",
                "m",
                "d",
                "d",
                "d",
                "d",
                "x"
            ]
        },
        {
            "id": 1,
            "tagger": [
                "ns",
                "ns",
                "nr",
                "nr",
                "nr",
                "nr",
                "n",
                "n",
                "d",
                "v",
                "v",
                "n",
                "n",
                "vn",
                "vn",
                "nr",
                "nr",
                "nr"
            ]
        },
        {
            "id": 2,
            "tagger": [
                "n",
                "n",
                "v",
                "v",
                "n",
                "n"
            ]
        }
    ],
    "ret_code": 0,
    "task": "pos"
}
### NER

- **描述**：使用本系统的NER方法，对序列中的token进行命名实体识别

- **URL**：`/ner` 

- **示例**：

  ```json
    # user输入sentence
    {
      "model" : "crf/mlp",   # 选择crf模型或mlp模型
      "data" : "华润医药控股拟通过增资与购买江中集团部分股权相结合的方式取得江中集团不低于51%股权成为其控股股东。"
    }
  ```
- **返回结果**：

  ```python
    {
    "entity_set": [
        [
            "华润医药控股",
            "abr_org"
        ],
        [
            "江中集团",
            "abr_org"
        ],
        [
            "华润医药",
            "abr_org"
        ]
    ],
    "ret_code": 0,
    "sentences": [
        [
            "华",
            "润",
            "医",
            "药",
            "控",
            "股",
            "拟",
            "通",
            "过",
            "增",
            "资",
            "与",
            "购",
            "买",
            "江",
            "中",
            "集",
            "团",
            "部",
            "分",
            "股",
            "权",
            "相",
            "结",
            "合",
            "的",
            "方",
            "式",
            "取",
            "得",
            "江",
            "中",
            "集",
            "团",
            "不",
            "低",
            "于",
            "5",
            "1",
            "%",
            "股",
            "权",
            "成",
            "为",
            "其",
            "控",
            "股",
            "股",
            "东"
        ],
        [
            "江",
            "西",
            "省",
            "国",
            "资",
            "委",
            "已",
            "签",
            "署",
            "战",
            "略",
            "合",
            "作",
            "协",
            "议",
            ",",
            "华",
            "润",
            "医",
            "药",
            "将",
            "以",
            "江",
            "中",
            "集",
            "团",
            "为",
            "发",
            "展",
            "平",
            "台",
            ",",
            "将",
            "其",
            "打",
            "造",
            "成",
            "为",
            "国",
            "内",
            "领",
            "先",
            "的",
            "综",
            "合",
            "性",
            "医",
            "药",
            "健",
            "康",
            "集",
            "团",
            ",",
            "带",
            "动",
            "江",
            "西",
            "省",
            "医",
            "药",
            "产",
            "业",
            "创",
            "新",
            "升",
            "级"
        ]
    ],
    "tags": [
        [
            "B-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "B-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "B-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O"
        ],
        [
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "B-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "O",
            "O",
            "B-abr_org",
            "I-abr_org",
            "I-abr_org",
            "I-abr_org",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O",
            "O"
        ]
    ],
    "task": "ner"
}


### 语义角色标注

- **描述**：使用本系统的NER方法，对序列中的token进行实体角色的标注

- **URL**：`/ner_rel` 

- **示例**：

  ```json
    # user输入sentence
    {
      "model" : "crf/mlp",   # 选择crf模型或mlp模型
      "data" : "华润医药控股拟通过增资与购买江中集团部分股权相结合的方式取得江中集团不低于51%股权成为其控股股东。"
    }
  ```
- **返回结果**：

  ```python
    {
    "ret_code": 0,
    "sentences": [
        "<abr_org>华润医药控股</abr_org>拟通过增资与购买<abr_org>江中集团</abr_org>部分股权相结合的方式取得<abr_org>江中集团</abr_org>不低于51%股权成为其控股股东",
        "江西省国资委已签署战略合作协议,<abr_org>华润医药</abr_org>将以<abr_org>江中集团</abr_org>为发展平台,将其打造成为国内领先的综合性医药健康集团,带动江西省医药产业创新升级"
    ],
    "task": "ner_rel"
}

